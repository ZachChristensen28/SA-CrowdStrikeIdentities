{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>This supporting add-on comes with prebuilt content for CrowdStrike Identity data to be easily used with Splunk Enterprise Security's Identity database.</p> <p>This Supporting add-on is only intended to work with Splunk Enterprise Security deployments.</p> <p>Disclaimer</p> <p>This Splunk Supporting Add-on is not affiliated with CrowdStrike, Inc. and is not sponsored or sanctioned by the CrowdStrike team. As such, the included documentation does not contain information on how to get started with CrowdStrike. Rather, this documentation serves as a guide to use CrowdStrike identity data with Splunk Enterprise Security. Please visit https://www.crowdstrike.com for more information about CrowdStrike.</p>"},{"location":"#assumptions","title":"Assumptions","text":"<p>This documentation assumes the following:</p> <ol> <li>You have a working Splunk Enterprise Security environment. This add-on is not intended to work without Splunk ES.</li> <li>You already have CrowdStrike identity data ingested using the Crowdstrike Falcon Identity Protection.</li> <li>Familiarity with setting up a new Asset source in Enterprise Security.</li> </ol>"},{"location":"#about","title":"About","text":"Info Description SA-CrowdStrikeIdentities 1.0.0 - Splunkbase | GitHub Splunk Enterprise Security Version (Required) 7.x | 6.x CrowdStrike Falcon Identity Protection Add-on (Required) &gt;=1.0.1 Add-on has a web UI No, this add-on does not contain views. <p>Quick Start</p>"},{"location":"configure/","title":"Configure","text":"<p>Each field can be customized to fit your environment. The following fields should be examined and tailored to your data.</p> <p>It is recommended to clone the default search before making changes (see Clone Saved Search).</p> <ul> <li>Update Priority</li> <li>Update Category</li> <li>Update Schedule</li> </ul>"},{"location":"configure/category/","title":"Category Field","text":"<p>To update the <code>category</code> field modify the <code>CrowdStrike Identities Lookup - Gen</code> saved search. It is recommended to clone the default search before making changes (see Clone Saved Search).</p> <p>The category field by default includes many important fields. Most will find that the default configuration for this field will work for their needs.</p> <p>This field is an eval statement with multiple functions to map and clean field values. See the Category Field reference for full field mappings and example values.</p>"},{"location":"configure/priority/","title":"Priority Field","text":"<p>To update the <code>priority</code> field modify the <code>CrowdStrike Identities Lookup - Gen</code> saved search. It is recommended to clone the default search before making changes (see Clone Saved Search).</p> <p>The priority field is very generic by default and should be updated to suite your environment. The following table describes how this field is set.</p> Type Condition Severity Description RegEx* admin <code>critical</code> Any identity that has the keyword \"admin.\" boolean true() <code>medium</code> catch-all. Remaining identities receive medium severity. <p>*Regex Match is performed on the category field.</p> Default priority field definition<pre><code>priority=case(\nmatch(category, \"admin\"), \"critical\",\ntrue(), \"medium\"\n)\n</code></pre>"},{"location":"configure/schedule/","title":"Update Schedule","text":"<p>To update the schedule modify the <code>CrowdStrike Identities Lookup - Gen</code> saved search. It is recommended to clone the default search before making changes (see Clone Saved Search).</p> <p>The default saved search runs on the 29th minute of every hour to update and continually build the CrowdStrike identities. Most users will find that this schedule works for their environment.</p> <p>To update the default schedule perform the following steps:</p> <ol> <li>Navigate to Settings &gt; Searches, reports, and alerts.</li> <li>Set the \"App\" dropdown to <code>SA-CrowdStrikeIdentities</code>.</li> <li>Set the \"Owner\" dropdown to <code>All</code>.</li> <li>Click \"Edit\" under actions for the search <code>CrowdStrike Identities Lookup - Gen</code> or the name of the cloned search (see Clone Saved Search).</li> <li>Click \"Edit Schedule\" and update the schedule and necessary.</li> </ol>"},{"location":"configure/best-practice/clone-search/","title":"Clone default saved search","text":"<p>In order to preserve the default behavior and to compare changes to new releases, it is recommended to clone the default search <code>CrowdStrike Identities Lookup - Gen</code> before making any changes.</p>"},{"location":"configure/best-practice/clone-search/#clone","title":"Clone","text":"<p>Perform the following to clone the default search:</p> <ol> <li>Navigate to Settings &gt; Searches, reports, and alerts.</li> <li>Change \"App\" filter to <code>SA-CrowdStrikeIdentities</code>.</li> <li>Change \"Owner\" to <code>All</code>.</li> <li>For the search named \"CrowdStrike Identities Lookup - Gen\" click \"Edit\" under Actions.</li> <li>From the dropdown menu click \"Clone.\"</li> <li>(optional) Update the Title.</li> <li>Set \"Permissions\" to <code>clone</code>.</li> <li>Click \"Clone Report\" to finish.</li> </ol>"},{"location":"configure/best-practice/clone-search/#disable-default-search","title":"Disable default search","text":"<p>Disable the original search:</p> <ol> <li>For the search named \"CrowdStrike Identities Lookup - Gen\" click \"Edit\" under Actions.</li> <li>From the dropdown menu click \"Disable\" to disable the default search.</li> </ol>"},{"location":"quickstart/install/","title":"Install","text":"<p>Important</p> <p>This supporting add-on must be installed alongside Splunk Enterprise Security. Ensure the prequisites have been completed before proceeding.</p> <p>For detailed information on where to install Splunk Apps/add-ons, including best practices, can be found at Splunk Docs: About Installing Splunk add-ons.</p>"},{"location":"quickstart/install/#standalone-deployments-with-splunk-es","title":"Standalone Deployments (with Splunk ES)","text":"<p>Install this add-on to the single instance. For more information see Splunk Docs: Install add-on in a single-instance Splunk deployment.</p>"},{"location":"quickstart/install/#distributed-deployments","title":"Distributed Deployments","text":"Splunk Instance type Supported Required Comments Enterprise Security Search Head Yes Yes Install this add-on to the Enterprise Security Search Head. Splunk Core Search Head (without ES) No No Do not install on regular search heads. Indexers No No Do not install on Indexers. Heavy Forwarders No No Do not install on Heavy Forwarders. Universal Forwarders No No Do not install on Universal Forwarders. <p>The installation steps for deploying Apps/add-ons in a distributed environment can be found at Splunk Docs: Install an add-on in a distributed Splunk deployment.</p>"},{"location":"quickstart/install/#distributed-deployment-compatibility","title":"Distributed Deployment Compatibility","text":"Distributed deployment feature Supported Comments Search Head Clusters Yes You can install this add-on to an Enterprise Security search head cluster. Indexer Clusters No Do not deploy this add-on to an Indexer cluster. Deployment Server No There is no need to use a deployment server to deploy this add-on. <p>* For more information, see Splunk's documentation on installing Add-ons.</p>"},{"location":"quickstart/prerequisites/","title":"Prerequisites","text":"<p>Important</p> <p>Complete the prerequisites before installing this add-on.</p> Required App Version Description Splunk Enterprise Security 7.x | 6.x This add-on supports Splunk ES and is not designed to work without it. Crowdstrike Falcon Identity Protection Add-on &gt;=1.0.1 CrowdStrike Identity data must be brought in prior to installing this add-on. See the documentation for more information."},{"location":"quickstart/quickstart/","title":"Quick Start","text":"<p>Important</p> <p>This supporting add-on must be installed alongside Splunk Enterprise Security. Ensure the prequisites have been completed before proceeding.</p> <p>This add-on has a savedsearch and identity configuration input enabled by default.</p>"},{"location":"quickstart/quickstart/#overview","title":"Overview","text":"<ol> <li>Updated default macro.</li> <li>Force Initial Build.</li> <li>Enable identity correlation.</li> <li>(optional) Disable existing identity sources.</li> <li>(optional) Update default savedsearch schedule.</li> </ol>"},{"location":"quickstart/quickstart/#update-default-macro","title":"Update default macro","text":"<p>Danger, Will Robinson</p> <p>Failure to update the macro to the correct setting will cause no identities to be available in Splunk Enterprise Security.</p> Macro Default Description <code>sa_crowdstrike_identities_index</code> index=crowdstrike Index definition for CrowdStrike identity index."},{"location":"quickstart/quickstart/#update-macro-procedure","title":"Update Macro Procedure","text":"<p>Update the index definition to the correct index that contains the <code>crowdstrike:identities</code> sourcetype.</p> <p>Perform one of the following:</p> <ol> <li>(recommended) Update via Splunk ES General Settings.</li> <li>Update via Macro Definition.</li> </ol>"},{"location":"quickstart/quickstart/#es-general-settings","title":"ES General Settings","text":"<p>option 1 (recommended option)</p> <ol> <li>(In Splunk Enterprise Security) Navigate to Configure &gt; General &gt; General Settings.</li> <li>From the \"App\" dropdown select <code>SA-CrowdStrikeIdentities</code>.</li> <li>Update the SA-CrowdStrikeIdentities Index definition and click \"Save.\"</li> </ol>"},{"location":"quickstart/quickstart/#macro-definition","title":"Macro Definition","text":"<p>option 2</p> <ol> <li>Navigate to Settings &gt; Advanced Search &gt; Search Macros.</li> <li>From the \"App\" dropdown choose <code>SA-CrowdStrikeIdentities</code>.</li> <li>Set the \"Owner\" dropdown to <code>any</code>.</li> <li>Click the macro named <code>sa_crowdstrike_identities_index</code> to update the index definition.</li> </ol>"},{"location":"quickstart/quickstart/#force-initial-build","title":"Force Initial Build","text":"<p>The initial build of the CrowdStrike identities will not occur until the first scheduled runtime (see Update default savedsearch schedule). To force the initial build perform the following:</p> <ol> <li>Navigate to Settings &gt; Searches, reports, and alerts.</li> <li>Set the \"App\" dropdown to <code>SA-CrowdStrikeIdentities</code>.</li> <li>Set the \"Owner\" dropdown to <code>All</code>.</li> <li>Click \"Run\" under actions for the search <code>CrowdStrike Identities Lookup - Gen</code>.</li> </ol> <p>Note</p> <p>The search will run in a new tab over the default time period of 60 minutes. Expand the time frame to a larger window if the number of identities in the last 60 minutes does not seem accurate. The default search is configured to run hourly to continually append new identities reported from CrowdStrike.</p>"},{"location":"quickstart/quickstart/#enable-asset-correlation","title":"Enable asset correlation","text":"<p>Confirm asset correlation has been setup in Enterprise Security.</p> <ol> <li>Navigate to Enterprise Security &gt; Configure &gt; Data Enrichment &gt; Asset and Identity Management.</li> <li>Switch to the \"Correlation Setup\" tab.</li> <li>Either enable for all sourcetypes (Recommended) or selectively by sourcetype.<ul> <li>If you choose to enable select sourcetypes, ensure the <code>stash</code> sourcetype is also selected so Notable events will be enriched with asset information.</li> </ul> </li> <li>Save.</li> </ol>"},{"location":"quickstart/quickstart/#disable-existing-identity-sources","title":"Disable existing identity sources","text":"<p>optional</p> <p>It may be possible that you have existing Identity Lookups defined. If CrowdStrike is the main \"source of truth\" in your environment the existing lookups may no longer be needed.</p>"},{"location":"quickstart/quickstart/#update-default-savedsearch-schedule","title":"Update default savedsearch schedule","text":"<p>optional</p> <p>The default saved search runs on the 29th minute of every hour to update and continually build the CrowdStrike identities. To update the default schedule perform the following steps:</p> <ol> <li>Navigate to Settings &gt; Searches, reports, and alerts.</li> <li>Set the \"App\" dropdown to <code>SA-CrowdStrikeIdentities</code>.</li> <li>Set the \"Owner\" dropdown to <code>All</code>.</li> <li>Click \"Edit\" under actions for the search <code>CrowdStrike Identities Lookup - Gen</code>.</li> <li>Click \"Edit Schedule\" and update the schedule and necessary.</li> </ol>"},{"location":"reference/all-configurations/","title":"All Configurations","text":"<p>Below is a table that list all configuration for this add-on.</p> Name Type Web Location CLI Location* Description CrowdStrike Identities Lookup - Gen Saved Search Settings &gt; Searches reports, and alerts savedsearches.conf Populates the lookup file <code>crowdstrike_identities</code>. crowdstrike_identities lookup Settings &gt; Lookups &gt; Lookup definitions transforms.conf Lookup definition for the KVStore collection <code>crowdstrike_identities_collection</code>. crowdstrike_identities_collection KVStore collection n/a** collections.conf KVStore configuration. sa_crowdstrike_identities_index Search macro Settings &gt; Advanced Search &gt; Search Macros macros.conf Index definition for the CrowdStrike index that contains the sourcetype <code>crowdstrike:identities</code>. identity_manager://crowdstrike_identities Identity lookup configuration Enterprise Security &gt; Configure &gt; Data Enrichment &gt; Asset and Identity Management &gt; Identity Lookups inputs.conf Identity configuration lookup to load CrowdStrike Identities into the identity database. <p>*CLI locations are relative to <code>../default</code>. Any update to CLI configuration files should be done in the local directory.</p> <p>Tip</p> <p>**If you have the Splunk App for Lookup File Editing, the KVStore collection <code>crowdstrike_identities_collection</code> is viewable within the Web interface.</p>"},{"location":"reference/category/","title":"Category","text":""},{"location":"reference/category/#default-category-field-mapping","title":"Default category field mapping","text":"Mapped Field CrowdStrike Event Field Example value account_control <code>accounts{}.userAccountControl</code> 512 archived <code>archived</code> false domain <code>accounts{}.domain</code> zachthesplunker.com enabled <code>accounts{}.enabled</code> true ou <code>accounts{}.ou</code> zachthesplunker.local/dev/users pass_last_updated <code>accounts{}.passwordAttributes.lastChange</code> 2021-10-11t16:46:56.000z risk_factors <code>riskFactors{}.type</code> stale_account,weak_password_policy risk_score <code>riskScore</code> 0.43 risk_score_severity <code>riskScoreSeverity</code> normal roles <code>roles{}.type</code> humanuseraccountrole,localadmin splunk_last_updated n/a 08/26/22 18:54:42 MDT title <code>accounts{}.title</code> splunker watched <code>watched</code> true"},{"location":"reference/category/#full-example-of-category-value","title":"Full example of category value","text":"<pre><code>account_control: 512\narchived: false\ndomain: zachthesplunker.com\nenabled: true\ngen: sa-crowdstrike\nou: zachthesplunker.local/dev/users\npass_last_updated: 2021-10-11t16:46:56.000z\nrisk_factors: stale_account,weak_password_policy\nrisk_score: 0.43\nrisk_score_severity: normal\nroles: humanuseraccountrole\nsplunk_last_updated: 06/08/23 22:43:40 mdt\ntitle: Splunker\nwatched: true\n</code></pre>"},{"location":"reference/identity-mapping/","title":"Identity Database Mapping","text":"<p>The following table describes how this add-on maps to the Identity Database.</p> <p>reference Format an asset or identity in Splunk ES</p> ES Identity lookup field CrowdStrike Identity TA Fields Example value Multi-value allowed identity <code>accounts{}.samAccountName</code> + <code>accounts{}.upn</code> zach@zachthesplunker.com|zachthesplunker true first <code>primaryDisplayName</code> zach false email <code>emailAddresses{}</code> zach@ztsplunker.com false priority see Configure Priority medium false bunit <code>accounts{}.department</code> finance true category see Category field reference see Category field reference true"},{"location":"releases/","title":"Release notes","text":""},{"location":"releases/#v100-june-8-2023","title":"v1.0.0 June 8, 2023","text":""},{"location":"releases/#compatibility","title":"Compatibility","text":"Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x CrowdStrike Falcon Identity Protection Add-on &gt;=1.0.1"},{"location":"releases/#whats-changed","title":"What's Changed","text":"<ul> <li>Initial release</li> </ul> <p>Full Changelog: v1.0.0</p>"},{"location":"releases/#known-issues","title":"Known issues","text":"Issue Description Solution GitHub issue reference Lookup file error You may see the error <code>status=\"Lookup file error, unknown path or update time\" name=crowdstrike_identities</code> This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation. Issue #2 <p>Issues or feature requests can be reported on the SA-CrowdStrikeIdentities's Github page.</p>"},{"location":"troubleshooting/","title":"Troubleshooting","text":"<p>There can be many issues when setting up a new app/add-on in Splunk. Below highlights the most common issues with this Add-on. Don't see your issue? Submit a new issue on Github.</p> Issue Description Solution Identity Database not populating with CrowdStrike Data The identity database may show no CrowdStrike data if the initial search has not run to build the identity database or the default macro has not been updated. Verify the default macro has the correct index definition (see Update Default Macro). Also see Force build to build the CrowdStrike identity lookup before the first scheduled run."}]}